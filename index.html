<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ì–´ë–¤ ì¬ë£Œë¥¼ ì‚¬ìš©í•´ ë³¼ê¹Œìš”?</title>
<style>
  :root{
    --accent:#3B82F6;                 /* í¬ì¸íŠ¸ ì»¬ëŸ¬(í•€/ë²„íŠ¼) */
    --bg:#f6f7f9; --card:#fff; --ink:#111; --line:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:980px;margin:0 auto;padding:28px 16px}
  /* íƒ€ì´í‹€ì„ ë¸”ë™ìœ¼ë¡œ */
  h1{margin:8px 0 22px;font-size:32px;text-align:center;color:#000}

  .grid{display:grid;gap:20px}
  @media(min-width:900px){.grid{grid-template-columns:560px 1fr}}

  .card{background:var(--card);border-radius:18px;box-shadow:0 8px 24px rgba(0,0,0,.08);overflow:hidden}
  .pad{padding:20px}

  /* ====== íœ  í¬ê¸°(ë„ˆë¬´ ì»¤ì§€ëŠ” ê²ƒ ë°©ì§€) ====== */
  .wheel-box{width:min(92vw,520px);margin:0 auto;}
  .wheel-wrap{position:relative;width:100%;aspect-ratio:1/1;}
  svg{width:100%;height:100%;display:block}
  #slices,#labels{transform-box:fill-box;transform-origin:50% 50%}

  /* ìƒë‹¨ í•€ */
  .pin{position:absolute;left:50%;transform:translateX(-50%);top:-4px;width:0;height:0;
       border-left:14px solid transparent;border-right:14px solid transparent;
       border-top:24px solid var(--accent);filter:drop-shadow(0 2px 2px rgba(0,0,0,.25))}

  .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;justify-content:center}
  button{border:0;border-radius:12px;padding:12px 18px;font:inherit;cursor:pointer}
  .primary{background:var(--accent);color:#fff}
  .ghost{background:#eef4ff;color:var(--accent)}
  .danger{background:#ef4444;color:#fff}

  .result{font-weight:800;font-size:22px;margin:16px 0 0;text-align:center} /* êµ¬ë¶„ì„  ì œê±° â†’ margin-bottom 0 */
  /* .soft-divider ì œê±° (ì‚¬ìš© ì•ˆí•¨) */

  .inputs-title{margin:0 0 6px;font-size:18px}
  .inputs{display:flex;flex-direction:column;gap:8px;margin-top:10px}
  .input-row{display:flex;gap:8px}
  .input-row input{flex:1;border:1px solid var(--line);border-radius:10px;padding:10px 12px;font:inherit}
</style>
</head>
<body>
<div class="wrap">
  <h1>ì–´ë–¤ ì¬ë£Œë¥¼ ì‚¬ìš©í•´ ë³¼ê¹Œìš”?</h1>

  <div class="grid">
    <!-- ====== ì™¼ìª½: ëŒë¦¼íŒ ====== -->
    <div class="card pad">
      <div class="wheel-box">
        <div class="wheel-wrap">
          <div class="pin"></div>
          <svg viewBox="-50 -50 100 100" aria-label="ëœë¤ ëŒë¦¼íŒ">
            <g id="slices" style="transition:transform 5s cubic-bezier(.12,.2,0,1)"></g>
            <g id="labels" style="transition:transform 5s cubic-bezier(.12,.2,0,1)"></g>
          </svg>
        </div>
      </div>

      <div class="row">
        <button id="spin" class="primary">ëŒë¦¬ê¸°</button>
        <button id="reset" class="ghost">ì²˜ìŒ ìƒíƒœë¡œ</button>
      </div>

      <div id="result" class="result">ì„ íƒëœ ì¬ë£Œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</div>
      <!-- êµ¬ë¶„ì„  ìš”ì†Œ ì‚­ì œ -->
    </div>

    <!-- ====== ì˜¤ë¥¸ìª½: ì…ë ¥ì°½ ====== -->
    <div class="card pad">
      <h2 class="inputs-title">ì¬ë£Œ í•­ëª© ì…ë ¥</h2>
      <div class="inputs" id="inputs"></div>
      <div class="row">
        <button id="add" class="ghost">í•­ëª© ì¶”ê°€</button>
        <button id="clear" class="danger">ëª¨ë‘ ì‚­ì œ</button>
      </div>
    </div>
  </div>
</div>

<script>
  /* ========= ìƒìˆ˜/ìœ í‹¸ ========= */
  const PASTELS = ['#D9ECFF','#FFE4EA','#FFF6C9','#DDF8EA','#E9D8FD','#FFE8CC']; // í•˜ëŠ˜Â·í•‘í¬Â·ë°”ë‚˜ë‚˜Â·ë¯¼íŠ¸Â·ë¼ë²¤ë”Â·í”¼ì¹˜
  const deg2rad = d => d * Math.PI / 180;

  /* ========= ì „ì—­ ìƒíƒœ/DOM ========= */
  const gSlices = document.getElementById('slices');
  const gLabels = document.getElementById('labels');
  const inputsBox = document.getElementById('inputs');
  const resultEl  = document.getElementById('result');

  // ì´ˆê¸° í•­ëª©(ì…ë ¥ì¹¸ì— ë¯¸ë¦¬ ì±„ì›Œì§)
  let items = ["ë³‘ëšœê»‘","ì¢…ì´","ë¹¨ëŒ€"];

  /* ========= ëŒë¦¼íŒ ê·¸ë¦¬ê¸° ========= */
  function drawWheel(){
    const nRaw = items.length;
    const n = nRaw > 0 ? nRaw : 1;        // 0ê°œì¼ ë•Œë„ ì•ˆì „í•˜ê²Œ
    gSlices.innerHTML = '';
    gLabels.innerHTML = '';
    const slice = 360 / n;

    for (let i=0;i<n;i++){
      // ê°ë„ ê³„ì‚°(12ì‹œ ê¸°ì¤€)
      const start = i*slice - 90;
      const end   = (i+1)*slice - 90;
      const x1 = 48*Math.cos(deg2rad(start)), y1 = 48*Math.sin(deg2rad(start));
      const x2 = 48*Math.cos(deg2rad(end)),   y2 = 48*Math.sin(deg2rad(end));
      const large = slice > 180 ? 1 : 0;

      // ë¶€ì±„ê¼´ ì¡°ê°
      const p = document.createElementNS('http://www.w3.org/2000/svg','path');
      p.setAttribute('d', `M0 0 L ${x1} ${y1} A 48 48 0 ${large} 1 ${x2} ${y2} Z`);
      p.setAttribute('fill', PASTELS[i % PASTELS.length]);
      gSlices.appendChild(p);

      // ë¼ë²¨: ì¤‘ì•™ê° ê¸°ì¤€ ë°°ì¹˜ + ì•„ë˜ìª½ì´ë©´ 180Â° ë’¤ì§‘ê¸°(í•­ìƒ ì •ë°©í–¥)
      const mid = start + slice/2;
      const rLabel = 28; // ê¸€ì ìœ„ì¹˜ ë°˜ì§€ë¦„
      const rx = rLabel*Math.cos(deg2rad(mid));
      const ry = rLabel*Math.sin(deg2rad(mid));
      let angle = mid;
      const norm = (angle % 360 + 360) % 360;
      if (norm > 90 && norm < 270) angle += 180;

      const t = document.createElementNS('http://www.w3.org/2000/svg','text');
      t.setAttribute('x', rx);
      t.setAttribute('y', ry);
      t.setAttribute('text-anchor','middle');
      t.setAttribute('dominant-baseline','middle');
      t.setAttribute('font-size','5.5');     // í•„ìš”ì‹œ 5~6 ì‚¬ì´ ì¡°ì ˆ
      t.setAttribute('font-weight','800');
      t.setAttribute('fill', '#111');
      t.setAttribute('transform', `rotate(${angle} ${rx} ${ry})`);

      const label = (items[i] ?? '').toString().trim() || 'í•­ëª©';
      t.textContent = label.length > 6 ? label.slice(0,6)+'â€¦' : label;
      gLabels.appendChild(t);
    }
  }

  /* ========= ì…ë ¥ì°½(í•­ëª© ì¶”ê°€/ì‚­ì œ/ì‹¤ì‹œê°„ ë°˜ì˜) ========= */
  function rowTemplate(value=''){
    const row = document.createElement('div');
    row.className = 'input-row';
    const input = document.createElement('input');
    input.type = 'text';
    input.placeholder = 'ìˆ˜ì§‘í•œ ì¬ë£Œë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”. (ì˜ˆ: íœ´ì§€ì‹¬)';
    input.value = value;
    const del = document.createElement('button');
    del.textContent = 'ì‚­ì œ';
    del.className = 'danger';
    row.appendChild(input); row.appendChild(del);

    input.addEventListener('input', syncFromInputs);
    input.addEventListener('keydown', e=>{
      if(e.key==='Enter'){ e.preventDefault(); addRow(); }
    });
    del.addEventListener('click', ()=>{ row.remove(); syncFromInputs(); });

    return row;
  }
  function renderInputs(){
    inputsBox.innerHTML = '';
    (items.length ? items : ['']).forEach(v=> inputsBox.appendChild(rowTemplate(v)));
  }
  function collectItems(){
    return Array.from(inputsBox.querySelectorAll('input'))
      .map(i=>i.value.trim()).filter(Boolean);
  }
  function syncFromInputs(){ items = collectItems(); drawWheel(); }

  // UI ë²„íŠ¼
  function addRow(value=''){
    inputsBox.appendChild(rowTemplate(value));
    inputsBox.lastChild.querySelector('input').focus();
  }
  document.getElementById('add').addEventListener('click', ()=> addRow());
  document.getElementById('clear').addEventListener('click', ()=>{
    inputsBox.innerHTML=''; items=[]; drawWheel(); resultEl.textContent='ì„ íƒëœ ì¬ë£Œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤';
  });
  document.getElementById('reset').addEventListener('click', ()=>{
    items=["ë³‘ëšœê»‘","ì¢…ì´","ë¹¨ëŒ€"]; renderInputs(); drawWheel(); resultEl.textContent='ì„ íƒëœ ì¬ë£Œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤';
  });

  /* ========= íšŒì „(í•­ìƒ â€˜ì²˜ìŒì²˜ëŸ¼â€™ í¬ê²Œ ëŒê²Œ) ========= */
  function spinOnce(){
    if(!items.length){ alert('í•­ëª©ì„ 1ê°œ ì´ìƒ ì…ë ¥í•´ ì£¼ì„¸ìš”.'); return; }
    const n = items.length, slice = 360/n;
    const pickIndex = Math.floor(Math.random()*n);
    const targetAngle = pickIndex * slice;              // ì„ íƒ ì„¹í„° ì‹œì‘ê°
    const alignToTop = 360 - (targetAngle + slice/2);   // ì¤‘ì•™ê°ì„ 12ì‹œë¡œ ì •ë ¬
    const spins = 6*360;                                // ì¶©ë¶„íˆ ë§ì´
    const finalDeg = spins + alignToTop;

    // ğŸ’¡ ë‘ ë²ˆì§¸ë¶€í„° â€˜ì°”ë”â€™ ë¬¸ì œ í•´ê²°:
    //   1) transition ì œê±°í•˜ê³  ê°ë„ë¥¼ 0ìœ¼ë¡œ ë¦¬ì…‹
    //   2) ë¦¬í”Œë¡œìš° í›„ transition ë³µì›í•˜ê³  ìµœì¢… ê°ë„ë¡œ íšŒì „
    const tr = 'transform 5s cubic-bezier(.12,.2,0,1)';
    gSlices.style.transition = 'none';
    gLabels .style.transition = 'none';
    gSlices.style.transform  = 'rotate(0deg)';
    gLabels .style.transform = 'rotate(0deg)';
    // ë¦¬í”Œë¡œìš°(ê°•ì œ ê³„ì‚°)
    void gSlices.offsetWidth;

    gSlices.style.transition = tr;
    gLabels .style.transition = tr;
    gSlices.style.transform  = `rotate(${finalDeg}deg)`;
    gLabels .style.transform = `rotate(${finalDeg}deg)`;

    // ê²°ê³¼ í‘œì‹œ
    setTimeout(()=>{ resultEl.textContent = `ì„ íƒëœ ì¬ë£Œ: ${items[pickIndex]}`; }, 5000);
  }
  document.getElementById('spin').addEventListener('click', spinOnce);

  /* ========= ì´ˆê¸° ë Œë” ========= */
  (function init(){ renderInputs(); drawWheel(); })();
</script>
</body>
</html>
